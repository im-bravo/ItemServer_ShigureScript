// 米内葛尔岛刷勾玉碎片 - 队员
// 请手动定居在阿凯鲁法以提升效率。不定居在阿凯鲁法也行，但是回补会很慢。

isSettledInAKaiTown = 信息提示("你并没有定居在阿凯鲁法？", 36) != 5
isSayBack = 信息提示("是否要求队员发出回补指令",36)

如果( isSayBack == 5 )
	curPet = 当前出战宠物()
	humanBackHP = 人物详细信息(3)*0.5
	humanBackMP = 人物详细信息(5)*0.05
	// 如果(获取技能信息("补血魔法") > 7)
		// humanBackMP = 人物详细信息(5)*0.25
	// 如果尾()
	petBackHP = 宠物详细信息(curPet,3)*0.4
	petBackMP = 宠物详细信息(curPet,5)*0.05
	isAutoSettings = 信息提示("是否以下列数值作为设置{ " $ "人回补血:" $ humanBackHP $ ", " $ "人回补魔:" $ humanBackMP $ ", " $ "宠回补血:" $ petBackHP $ ", " $ "宠回补魔:" $ petBackMP $ " }",36)
	如果(isAutoSettings != 5)
		humanBackHP = 信息输入("人回补血值","人回补血值",humanBackHP)
		humanBackMP = 信息输入("人回补魔值","人回补魔值",humanBackMP)
		petBackHP = 信息输入("宠回补血值","宠回补血值",petBackHP)
		petBackMP = 信息输入("宠回补魔值","宠回补魔值",petBackMP)
	如果尾()
如果尾()

//刷勾玉，回补
curAction = "刷勾玉"

//有些地图名称一样，所以通过前一张地图来判断
prevPlace = ""

循环( 1 )

	循环(人物详细信息(34) == "艾尔莎岛")
		如果(人物详细信息(37) < 2)
			移动到(140,105)
			循环(人物详细信息(34) != "里谢里雅堡")
				对话NPC(1,2,"","","",2)
				tryCount = 0
				循环(tryCount < 20 && 人物详细信息(34) != "里谢里雅堡")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			循环尾()
		如果尾()
	循环尾()

	循环(人物详细信息(34) == "里谢里雅堡")
		如果(人物详细信息(37) < 2)
			自动寻路(41,51)
			移动到(41,50)
			//等0~4s过图
			tryCount = 0
			循环(tryCount < 40 && 人物详细信息(34) != "里谢里雅堡\S1楼\\z0")
				等待(100)
				tryCount = tryCount + 1
			循环尾()
		如果尾()
	循环尾()

	循环(人物详细信息(34) == "里谢里雅堡\S1楼\\z0")
		如果(人物详细信息(37) < 2)
			自动寻路(45,21)
			移动到(45,20)
			//等0~4s过图
			tryCount = 0
			循环(tryCount < 40 && 人物详细信息(34) != "启程之间\\z0")
				等待(100)
				tryCount = tryCount + 1
			循环尾()
		如果尾()
	循环尾()

	循环(人物详细信息(34) == "启程之间\\z0")
		如果(人物详细信息(37) < 2)
			循环(人物详细信息(34) != "伊尔村的传送点\\z0")
				自动寻路(43,32)
				对话NPC(2,2,"","","",2)
				tryCount = 0
				循环(tryCount < 20 && 人物详细信息(34) != "伊尔村的传送点\\z0")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			循环尾()
		如果尾()
	循环尾()

	循环(人物详细信息(34) == "伊尔村的传送点\\z0")
		如果(人物详细信息(37) < 2)
			自动寻路(12,18)
			移动到(12,17)
			//等0~4s过图
			tryCount = 0
			循环(tryCount < 40 && 人物详细信息(34) != "村长的家\\z0")
				等待(100)
				tryCount = tryCount + 1
			循环尾()
		如果尾()
	循环尾()

	循环(人物详细信息(34) == "村长的家\\z0")
		如果(人物详细信息(37) < 2)
			自动寻路(7,13)
			移动到(6,13)
			//等0~4s过图
			tryCount = 0
			循环(tryCount < 40 && 人物详细信息(34) != "伊尔村")
				等待(100)
				tryCount = tryCount + 1
			循环尾()
		如果尾()
	循环尾()

	循环(人物详细信息(34) == "伊尔村")
		如果(人物详细信息(37) < 2)
			循环(人物详细信息(34) != "伊尔")
				自动寻路(58,71)
				对话NPC(2,2,"","","",2)
				tryCount = 0
				循环(tryCount < 20 && 人物详细信息(34) != "伊尔")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			循环尾()
		如果尾()
	循环尾()

	循环(人物详细信息(34) == "伊尔")
		如果(人物详细信息(37) < 2)
			自动寻路(29,21)
			移动到(30,21)
			//等0~4s过图
			tryCount = 0
			循环(tryCount < 40 && 人物详细信息(34) != "港湾管理处\\z0")
				等待(100)
				tryCount = tryCount + 1
			循环尾()
		如果尾()
		prevPlace = "伊尔"
	循环尾()

	循环(人物详细信息(34) == "港湾管理处\\z0")
		flag = 0
		如果(prevPlace == "伊尔")
			flag = 1
			如果(人物详细信息(37) < 2)
				循环(人物详细信息(34) != "往阿凯鲁法栈桥")
					自动寻路(23,25)
					对话NPC(0,7,"","","",2)
					tryCount = 0
					循环(tryCount < 20 && 人物详细信息(34) != "往阿凯鲁法栈桥")
						等待(100)
						tryCount = tryCount + 1
					循环尾()
				循环尾()
			如果尾()
		如果尾()

		如果(prevPlace == "往伊尔栈桥")
			flag = 2
			如果(人物详细信息(37) < 2)
				自动寻路(22,30)
				移动到(22,31)
				//等0~4s过图
				tryCount = 0
				循环(tryCount < 40 && 人物详细信息(34) != "阿凯鲁法")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			如果尾()
		如果尾()

		如果(flag == 0)
			prevPlace = "伊尔"
		如果尾()
	循环尾()

	循环(人物详细信息(34) == "往阿凯鲁法栈桥")
		如果(人物详细信息(37) < 2)
			循环(人物详细信息(34) != "艾欧奇亚号\\z0")
				自动寻路(51,50)
				对话NPC(2,2,"","","",2)
				tryCount = 0
				循环(tryCount < 20 && 人物详细信息(34) != "艾欧奇亚号\\z0")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			循环尾()
		如果尾()
	循环尾()

	循环(人物详细信息(34) == "艾欧奇亚号\\z0")
		如果(获取信息记录( "本船已到达了阿凯鲁法港。", "普通") == "船员")
			如果(人物详细信息(37) < 2)
				循环(人物详细信息(34) != "往伊尔栈桥")
					自动寻路(70,26)
					对话NPC(2,2,"","","",2)
					tryCount = 0
					循环(tryCount < 20 && 人物详细信息(34) != "往伊尔栈桥")
						等待(100)
						tryCount = tryCount + 1
					循环尾()
				循环尾()
			如果尾()
		如果尾()
	循环尾()

	循环(人物详细信息(34) == "往伊尔栈桥")
		如果(人物详细信息(37) < 2)
			循环(人物详细信息(34) != "港湾管理处\\z0")
				自动寻路(19,54)
				对话NPC(0,2,"","","",2)
				tryCount = 0
				循环(tryCount < 20 && 人物详细信息(34) != "港湾管理处\\z0")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			循环尾()
		如果尾()
		prevPlace = "往伊尔栈桥"
	循环尾()

	循环(人物详细信息(34) == "阿凯鲁法")
		如果(人物详细信息(37) < 2)
			循环(人物详细信息(34) != "阿凯鲁法村")
				自动寻路(28,30)
				对话NPC(2,2,"","","",2)
				tryCount = 0
				循环(tryCount < 20 && 人物详细信息(34) != "阿凯鲁法村")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			循环尾()
		如果尾()
	循环尾()

	循环(人物详细信息(34) == "阿凯鲁法村")
		curX = 人物详细信息(35)
		curY = 人物详细信息(36)
		flag = 0
		//从港湾出来56 177
		如果(curX >= 46 && curX <= 66 && curY >= 167 && curY <= 187)
			flag = 1
			//加队伍
			循环(人物详细信息(37) < 2)
				自动寻路(56,177)
				加入队伍(2,"")
				等待(500)
			循环尾()

			如果(curAction == "刷勾玉" && 人物详细信息(37) < 2)
				自动寻路(178,226)
				移动到(178,227)
				//等0~4s过图
				tryCount = 0
				循环(tryCount < 40 && 人物详细信息(34) != "米内葛尔岛")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			如果尾()
			如果(curAction == "回补" && 人物详细信息(37) < 2)
				自动寻路(196,209)
				移动到(196,208)
				//等0~4s过图
				tryCount = 0
				循环(tryCount < 40 && 人物详细信息(34) != "冒险者旅馆\S1楼\\z0")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			如果尾()
		如果尾()
		//从登录点出来99 165
		如果(curX >= 89 && curX <= 109 && curY >= 155 && curY <= 175)
			flag = 2
			//加队伍
			循环(人物详细信息(37) < 2)
				自动寻路(99,165)
				加入队伍(6,"")
				等待(500)
			循环尾()

			如果(curAction == "刷勾玉" && 人物详细信息(37) < 2)
				自动寻路(178,226)
				移动到(178,227)
				//等0~4s过图
				tryCount = 0
				循环(tryCount < 40 && 人物详细信息(34) != "米内葛尔岛")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			如果尾()
			如果(curAction == "回补" && 人物详细信息(37) < 2)
				自动寻路(196,209)
				移动到(196,208)
				//等0~4s过图
				tryCount = 0
				循环(tryCount < 40 && 人物详细信息(34) != "冒险者旅馆\S1楼\\z0")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			如果尾()
		如果尾()
		//从米内岛进来178 226
		如果(curX >= 168 && curX <= 188 && curY >= 206 && curY <= 226)
			flag = 3
			如果(curAction == "刷勾玉" && 人物详细信息(37) < 2)
				自动寻路(178,226)
				移动到(178,227)
				//等0~4s过图
				tryCount = 0
				循环(tryCount < 40 && 人物详细信息(34) != "米内葛尔岛")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			如果尾()
			如果(curAction == "回补" && 人物详细信息(37) < 2)
				自动寻路(196,209)
				移动到(196,208)
				//等0~4s过图
				tryCount = 0
				循环(tryCount < 40 && 人物详细信息(34) != "冒险者旅馆\S1楼\\z0")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			如果尾()
		如果尾()

		如果(flag == 0)
			如果(curAction == "刷勾玉" && 人物详细信息(37) < 2)
				自动寻路(178,226)
				移动到(178,227)
				//等0~4s过图
				tryCount = 0
				循环(tryCount < 40 && 人物详细信息(34) != "米内葛尔岛")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			如果尾()
			如果(curAction == "回补" && 人物详细信息(37) < 2)
				自动寻路(196,209)
				移动到(196,208)
				//等0~4s过图
				tryCount = 0
				循环(tryCount < 40 && 人物详细信息(34) != "冒险者旅馆\S1楼\\z0")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			如果尾()
		如果尾()

	循环尾()

	循环(人物详细信息(34) == "米内葛尔岛")
		curX = 人物详细信息(35)
		curY = 人物详细信息(36)
		flag = 0
		//从南恰拉山1通道出来298 405，或者从2通道出来314 399
		如果(curX >= 288 && curX <= 314 && curY >= 398 && curY <= 417)
			flag = 1
			如果(curAction == "刷勾玉" && 人物详细信息(37) < 2)
				自动寻路(313,399)
				移动到(314,399)
				//等0~4s过图
				tryCount = 0
				循环(tryCount < 40 && 人物详细信息(34) != "南恰拉山第2通路\\z0")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			如果尾()
			如果(curAction == "回补" && 人物详细信息(37) < 2)
				自动寻路(299,405)
				移动到(298,405)
				//等0~4s过图
				tryCount = 0
				循环(tryCount < 40 && 人物详细信息(34) != "南恰拉山第1通路\\z0")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			如果尾()
		如果尾()
		
		//米内葛尔岛其他地方
		如果(flag == 0)
			如果(curAction == "刷勾玉" && 人物详细信息(37) < 2)
				自动寻路(282,457)
				移动到(283,457)
				//等0~4s过图
				tryCount = 0
				循环(tryCount < 40 && 人物详细信息(34) != "南恰拉山第1通路\\z0")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			如果尾()
			如果(curAction == "回补" && 人物详细信息(37) < 2)
				自动寻路(203,346)
				移动到(203,345)
				//等0~4s过图
				tryCount = 0
				循环(tryCount < 40 && 人物详细信息(34) != "阿凯鲁法村")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			如果尾()
		如果尾()

	循环尾()

	循环(人物详细信息(34) == "南恰拉山第2通路\\z0")
		如果(curAction == "刷勾玉" && 人物详细信息(37) < 2)
			循环(人物详细信息(34) != "时波之祠")
				自动寻路(32,10)
				对话NPC(0,1,"","","",1)
				tryCount = 0
				循环(tryCount < 20 && 人物详细信息(34) != "时波之祠")
					等待(100)
					tryCount = tryCount + 1
				循环尾()
			循环尾()
		如果尾()
		如果(curAction == "回补" && 人物详细信息(37) < 2)
			自动寻路(9,59)
			//等0~4s过图
			tryCount = 0
			循环(tryCount < 40 && 人物详细信息(34) != "米内葛尔岛")
				等待(100)
				tryCount = tryCount + 1
			循环尾()
		如果尾()
	循环尾()

	循环(人物详细信息(34) == "南恰拉山第1通路\\z0")
		如果(curAction == "刷勾玉" && 人物详细信息(37) < 2)
			自动寻路(10,61)
			等待(1500)
			自动寻路(11,2)
			等待(1500)
			自动寻路(37,5)
			//等0~4s过图
			tryCount = 0
			循环(tryCount < 40 && 人物详细信息(34) != "米内葛尔岛")
				等待(100)
				tryCount = tryCount + 1
			循环尾()
		如果尾()
		如果(curAction == "回补" && 人物详细信息(37) < 2)
			自动寻路(19,9)
			等待(1500)
			自动寻路(12,41)
			等待(1500)
			自动寻路(26,64)
			//等0~4s过图
			tryCount = 0
			循环(tryCount < 40 && 人物详细信息(34) != "米内葛尔岛")
				等待(100)
				tryCount = tryCount + 1
			循环尾()
		如果尾()
	循环尾()

	循环(人物详细信息(34) == "时波之祠")
		//加队伍
		循环(人物详细信息(37) < 2)
			自动寻路(9,8)
			加入队伍(0,"")
			等待(500)
		循环尾()
		如果(curAction == "刷勾玉" && 人物详细信息(37) < 2)
			tryCount = 0
			循环( tryCount < 10 && 人物详细信息(34) != "时波之祠地下1楼\\z0\\z0")
				移动到(9,5)
				等待(1000)
				移动到(9,4)
				等待(1000)
				tryCount = tryCount + 1
			循环尾()
		如果尾()
		如果(curAction == "回补" && 人物详细信息(37) < 2)
			自动寻路(9,8)
			移动到(10,8)
			//等0~4s过图
			tryCount = 0
			循环(tryCount < 40 && 人物详细信息(34) != "南恰拉山第2通路\\z0")
				等待(100)
				tryCount = tryCount + 1
			循环尾()
		如果尾()
	循环尾()

	循环(人物详细信息(34) == "时波之祠地下1楼\\z0\\z0")
		如果(curAction == "刷勾玉")
			如果(isSayBack == 5)
				等待战斗结束()
				curPet = 当前出战宠物()
				如果(人物详细信息(2) < humanBackHP)
					发送聊天( "<back>", 1, 1 )
					curAction = "回补"
					跳出循环()
				如果尾()
				如果(人物详细信息(4) < humanBackMP)
					发送聊天( "<back>", 2, 1 )
					curAction = "回补"
					跳出循环()
				如果尾()
				如果(宠物详细信息(curPet,2) < petBackHP)
					发送聊天( "<back>", 3, 1 )
					curAction = "回补"
					跳出循环()
				如果尾()
				如果(宠物详细信息(curPet,4) < petBackMP)
					发送聊天( "<back>", 4, 1 )
					curAction = "回补"
					跳出循环()
				如果尾()
			如果尾()
			如果(寻找文本(获取信息记录("<back>","普通"), "[GP]") != -1)
				curAction = "回补"
				跳出循环()
			如果尾()
		如果尾()

		如果(curAction == "回补" && 人物详细信息(37) < 2)
			如果(isSettledInAKaiTown != 0)
				登出回城()
				等待(3000)
			如果尾()
		如果尾()
	循环尾()

	循环(人物详细信息(34) == "冒险者旅馆\S1楼\\z0")
		如果(curAction == "刷勾玉" && 人物详细信息(37) < 2)
			自动寻路(16,22)
			移动到(16,23)
			// 等0~4s过图
			tryCount = 0
			循环(tryCount < 40 && 人物详细信息(34) != "阿凯鲁法村")
				等待(100)
				tryCount = tryCount + 1
			循环尾()
		如果尾()

		如果(curAction == "回补")
			如果(人物详细信息(37) < 2)
				如果(isCommonNurse == 0)
					自动寻路(22,17)
					护士恢复(0)
					等待(1000)
				如果尾()
				如果(isCommonNurse != 0)
					自动寻路(24,17)
					护士恢复(0)
					等待(1000)
				如果尾()
			如果尾()

			循环( 获取信息记录("<back>","普通") != "" )
				//等待消除全部<back>
				等待(100)
			循环尾()

			curAction = "刷勾玉"
		如果尾()
	循环尾()

循环尾()
